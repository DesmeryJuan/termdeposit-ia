base=read.csv("banktermdeposit.csv",sep=";",header=TRUE)
base$euribor3m=NULL
base$nr.employed=NULL
base$marital=as.factor(base$marital)
base$education=as.factor(base$education)
base$default=as.factor(base$default)
base$housing=as.factor(base$housing)
base$loan=as.factor(base$loan)
base$contact=as.factor(base$contact)
base$month=as.factor(base$month)
base$day_of_week=as.factor(base$day_of_week)
base$poutcome=as.factor(base$poutcome)
base$y=as.factor(base$y)
set.seed(123);particion=createDataPartition(base$y,p=0.8,list=F)
entreno=base[particion,]
testeo=base[-particion,]
library(rpart)
arbol=rpart(y~.,entreno,method="class")
library(rpart.plot)
rpart.plot(arbol,extra=1,type=5)
arbolGrande=rpart(y~.,entreno,method="class",minsplit=0,cp=0)
rpart.plot(arbolGrande,type=5,extra=1)
x11();plotcp(arbolGrande)
podado3=prune(arbolGrande,cp=0.0034)
rpart.plot(podado3,type=5,extra=1)
